rules:
    - id: gcp-postgresql-log-min-message
      patterns:
        - pattern: resource
        - pattern-inside: |
              resource "google_sql_database_instance" "..." {
                ...
                database_flags {
                  ...
                  name  = "log_min_messages"
                  value = $VALUE
                  ...
                }
                ...
              }
        - metavariable-regex:
            metavariable: $VALUE
            regex: (?i)(DEBUG5|DEBUG4|DEBUG3|DEBUG2|DEBUG1|INFO|NOTICE|WARNING|ERROR|LOG|FATAL|PANIC)
      message: >-
        Ensure PostgreSQL database 'log_min_messages' flag is set to a valid value. Valid values
        are INFO, NOTICE, WARNING, LOG, FATAL, PANIC, DEBUG1, DEBUG2, DEBUG3, DEBUG4, and DEBUG5.
      metadata:
        category: best-practice
        technology:
          - terraform
          - gcp
      languages: [hcl]
      severity: WARNING
